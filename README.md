# Использование сигналов точного времени и частоты для планирования работы устройств интернета вещей

Данный репозиторий создан как дополнение к статье с одноимённым названием. В его основе лежит запись полосового сигнала на SDRPlay RSP1 с частотой дискретизации 8 МГц в WAV файл при помощи программы HDSDR для выделения из него сигналов RBU. Аудиозапись сигнала RBU с пониженной(только для прослушивания) частотой дискретизации приведена здесь же.  
Последовательность действий, происходящая в ходе работы:  

1. Запись сигнала на магнитную антенну через HDSDR на частоте 60 кГц. Частота приёма понижена для того, чтобы избежать постоянную составляющую(DC Offset), проявляющуюся в ходе работы SDR. Настройки записи приведены ниже.
![Спектрограмма сигнала](<Signal Spectrum.png>)
![Параметры записи](<Record preferences.png>)
2. Обработка сигнала в программе MATLAB:  
    1. Выделение квадратурных составляющих. Подробнее: [Понятие I/Q сигналов и квадратурной модуляции](https://radioprog.ru/post/415)
    2. Фильтрация сигнала КИХ фильтром низких частот с линейной фазочастотной характеристикой.Возможна также фильтрация БИХ фильтром для ускорения фильтрации с любой ФЧХ, после которой производится фазовая коррекция(например, функция filtfilt) Подробнее: [Физический смысл групповой задержки фильтра. Цифровые фильтры с линейной фазочастотной характеристикой](http://www.dsplib.ru/content/filters/linphase/linphase.html)
    3. Выделение амплитуды и фазы сигнала по формуле. Подробнее: [Понятие квадратурной демодуляции](https://radioprog.ru/post/416) 
    4. Компенсация фазовых искажений в связи со сдвигом приёмной частоты. Подробнее: [Выделение комплексной огибающей при случайной начальной фазе принятого сигнала и частотной расстройке гетеродина относительно несущей частоты сигнала](https://ru.dsplib.org/content/quadrature_mixer_df/quadrature_mixer_df.html)
    5. Построение графиков

**Примечание:** в коде приведено два типа выделения мгновенной фазы. Выделение фазы через арктангенс с последующей unwrap функцией и выделение фазы через производную, как в FM приёмнике, с последующим интегрированием для избежания арктангенса. Подробнее: [Демодуляция сигналов с угловой модуляцией. PM и FM демодуляторы](https://ru.dsplib.org/content/signal_fm_demod/signal_fm_demod.html)

В результате удалось выделить амлитуду и фазу искомого сигнала:

![Амплитуда сигнала](<Amplitude.png>)
![Фаза сигнала](<Phase.png>)